# Detecting malicious OOB: Part -1:  Hunting for OOB server - Interact.sh

### What's OOB?&#x20;

OOB (also known as Out of band) is often referred to as an external interaction by an application. Applications very often have functionality to interact with external sources on the Internet for various purposes. This functionality is often abused for SSRF (Server side request forgery) among other vulnerabilities.

<figure><img src="../../.gitbook/assets/image (39).png" alt=""><figcaption><p>A typical OOB request originating out of an SSRF exploitation.</p></figcaption></figure>

### What's needed for testing an OOB interaction?

For testing the presence of SSRF vulnerability of any other vulnerability (like Blind SQL) which involves OOB, security researchers use various tools such as "[`Burp collaborator`](https://portswigger.net/burp/documentation/collaborator)", "[`Interact.sh`](https://github.com/projectdiscovery/interactsh)", "[`DNSBin`](https://github.com/ettic-team/dnsbin)", "[`DNSObserver`](https://github.com/allyomalley/dnsobserver)". A unique URL is generated by respective tools and these URLs are used in payloads. When the vulnerable server sends request to the URL generated by the tool, the tool captures the request and documents the request.&#x20;

### Online OOB testing tools v/s self-hosted:

Security researchers and attackers use either an online or a self hosted tool. Below are few online options for security researchers:&#x20;

<table><thead><tr><th width="85.33333333333331">S No</th><th>Tool</th><th width="365">Pattern of URL that's generated.</th><th>Type</th></tr></thead><tbody><tr><td>1</td><td>Burp collaborator</td><td>*.burpcollaborator.net</td><td>Online, Commercial tool</td></tr><tr><td>2</td><td>Webhook.site</td><td>webhook.site/*</td><td>Online, No registration required</td></tr><tr><td>3</td><td>Pipedream</td><td>*.pip3dream.net</td><td>Online, registration required</td></tr><tr><td>4</td><td>Toptal</td><td>toptal.com/developers/postbin/*</td><td>Online, No registration required</td></tr><tr><td>5</td><td>Typedwebhook</td><td>https://typedwebhook.tools/webhook/*</td><td>Online, No registration required</td></tr><tr><td>6</td><td>Interact.sh self-hosted</td><td>Custom URL</td><td>Self-hosted</td></tr><tr><td>7</td><td>Interact.sh</td><td>*.oast.pro, *.oast.fun</td><td>Online, No registration required</td></tr><tr><td>8</td><td>SVIX Play</td><td>https://play.svix.com/in/*<br></td><td>Online, No registration required</td></tr></tbody></table>

### The need for detecting malicious OOB interaction:

As mentioned earlier, OOB interaction is very often associated with legitimate functionality and malicious vulnerability exploitation. Below are few examples of how malicious OOB interaction problem exists:&#x20;

* [Out of Band SQL Injection](https://www.invicti.com/learn/out-of-band-sql-injection-oob-sqli/)
* [Out of Band Remote File Inclusion](https://www.invicti.com/web-vulnerability-scanner/vulnerabilities/out-of-band-remote-file-inclusion/)
* [Out of Band SSRF exploitation](https://shahjerry33.medium.com/blind-ssrf-the-hide-seek-game-da9d0ecef2fb)

It's quite evident that exploitation of the vulnerability might involve an OOB interaction. Detecting the OOB interaction would mean the detection of a possible exploitation attempt. One way of differentiating malicious OOB v/s legitimate OOB interaction boils down to the destination. If we are able to identify if the destination host might be hosting a tool that's used to test OOB interactions.

### Detecting Interact.sh

We've established the fact that there are several alternatives to Burp collaborator and Interact.sh which don't require registration, but why are we behind Interact.sh?

<figure><img src="../../.gitbook/assets/image (41).png" alt="" width="375"><figcaption><p>LOL</p></figcaption></figure>

The reason for that is very simple, most of the discussed tools are easy to detect using the URL pattern. However, for "Interact.sh", it generates unique URLs on a domain of attackers choosing. This opens up a tremendous attack surface as it'd allow anyone to host their own server (for OOB testing) and integrate with latest offensive security tools like Nuclei, Burp, etc.

#### Detecting Interact.sh

A simple GET command provided an insight into the response that Interact.sh gives for a rrequest. If the response is carefully observed, there's a header that's unique to the way Interact.sh gives response. The X-Interactsh-Version header. The header can be modified using the source code or by giving command line parameter: check [this ](https://github.com/projectdiscovery/interactsh/blob/2dddf7f6e64c750bdc2b522a05e96aaf415a9c52/pkg/server/http\_server.go#L253)& [this](https://github.com/projectdiscovery/interactsh/blob/2dddf7f6e64c750bdc2b522a05e96aaf415a9c52/pkg/server/server.go#L103).

<figure><img src="../../.gitbook/assets/image (37).png" alt=""><figcaption><p>GET request &#x26; response pair.</p></figcaption></figure>

A simple [Shodan search](https://www.shodan.io/search?query=%22X-Interactsh-Version%22) resulted in \~400 hosts on the Internet. Don't get me wrong, it's possible to modify this through code but it's a good start.&#x20;

<figure><img src="../../.gitbook/assets/image (49).png" alt=""><figcaption><p>Shodan search for Interact.sh tool</p></figcaption></figure>

### Final thoughts

* By detecting Interact.sh or all the tools mentioned in the post, it's still possible that the attack might slip out of the hands as an adversary might simply host a python HTTP server (`python -m SimpleHTTPServer`) to host a server and record OOB interactions.&#x20;
* While this doesn't detect all possible malicious OOB interactions, something's better than nothing and considering that Interact.sh is a very popular tool that's used by security researcher (and possible attackers), it's a good thought to stay a step ahead.
* If you are a cloud security provider and you see someone is using your platform for hosting interact.sh, there's a very good chance that they're abusing your Terms of Service (or depends on your agreement with them) and hence you need to start looking at it.
* In the next parts, we'll talk about how we can detect malicious OOB communication using host based artefacts such as process-network communication, etc. If you would want me to dive me into something adjacent, please feel free to ping me: [`@pbssubhash`](https://twitter.com/pbssubhash)

Until then, Good Bye!

